syntax = "proto3";

option java_package = "com.soulfiremc.grpc.generated";
option java_multiple_files = true;

package soulfire.v1;

import "soulfire/common.proto";
import "google/protobuf/struct.proto";

message ServerConfig {
  repeated SettingsNamespace settings = 1;
}

message ServerInfoRequest {
}

message ServerInfoResponse {
  ServerConfig config = 1;
  // All available settings definitions that can be rendered by identifier
  repeated SettingsDefinition settings_definitions = 4;
  // Pages that group settings together (reference settings by identifier)
  repeated SettingsPage server_settings = 2;
  repeated ServerPlugin plugins = 3;
}

message ServerUpdateConfigRequest {
  ServerConfig config = 1;
}

message ServerUpdateConfigResponse {
}

// Granular config entry update (single key-value)
message ServerUpdateConfigEntryRequest {
  string namespace = 1;
  string key = 2;
  google.protobuf.Value value = 3;
}

message ServerUpdateConfigEntryResponse {
}

service ServerService {
  rpc GetServerInfo (ServerInfoRequest) returns (ServerInfoResponse) {}
  // Used only for profile import - sends entire config
  rpc UpdateServerConfig (ServerUpdateConfigRequest) returns (ServerUpdateConfigResponse) {}
  // Granular update for individual config entries
  rpc UpdateServerConfigEntry (ServerUpdateConfigEntryRequest) returns (ServerUpdateConfigEntryResponse) {}
}
